Reporting
=========

Source: ``reports/generator.py``

CloudAudit generates three report formats from a single scan:

Output Formats
--------------

All formats are generated by default (``--format all``). Specify a single format with
``--format json``, ``--format html``, or ``--format markdown``.

JSON Report
-----------

Machine-readable output suitable for SIEM ingestion, ticketing system integration, or
custom tooling. All findings include full metadata.

Structure:

.. code-block:: json

   {
     "meta": {
       "tool": "CloudAudit",
       "version": "2.0.0",
       "author": "xtawb",
       "author_url": "https://linktr.ee/xtawb",
       "generated_at": "2025-01-01T00:00:00Z",
       "organisation": "Acme Corp",
       "tagline": "Powered by xtawb | Defensive. Intelligent. Enterprise-Grade."
     },
     "scan": {
       "container_info": { ... },
       "findings": [
         {
           "file_url": "https://...",
           "file_name": ".env",
           "file_type": "Environment",
           "category": "Secret Exposure",
           "rule_name": "AWS_ACCESS_KEY",
           "description": "AWS Access Key ID detected ...",
           "severity": "Critical",
           "match": "AKIA12***",
           "context": "... surrounding lines ...",
           "line_number": 12,
           "recommendation": "Rotate this key immediately ...",
           "compliance_refs": ["CIS 2.1.5", "NIST IA-5"],
           "confidence": 0.97,
           "scanner": "DETERMINISTIC",
           "from_archive": false
         }
       ],
       "risk_score": 8.7,
       "ai_summary": "...",
       "total_files": 847,
       "scanned_files": 421,
       "archive_files": 3
     }
   }

HTML Report
-----------

A professional dark-theme report for stakeholder distribution. Sections:

* **Header** — Tool name, organisation, generation timestamp
* **Warning Banner** — Internal use only notice
* **Container Information** — Provider, name, URL, region, public access status
* **Audit Summary** — Stat cards (files found, scanned, archives, critical count, risk score)
* **AI Executive Summary** — Formatted AI-generated summary with emphasis styling
* **Technical Findings** — Per-finding cards with severity badge, rule, description, compliance, recommendation
* **Compliance Mapping** — Table mapping each control reference to the rules that triggered it
* **File Inventory** — First 250 discovered files with type and size
* **Footer** — Tool version, author, author URL, defensive notice

Findings are tagged visually:

* ``[AI]`` badge (green) — AI heuristic detection
* ``[ARCHIVE]`` badge (purple) — Finding from inside an extracted archive

Markdown Report
---------------

Confluence, Notion, Jira, and GitHub wiki compatible. Contains the same sections as HTML
in Markdown table format.

Report Sections (All Formats)
------------------------------

.. list-table::
   :header-rows: 1
   :widths: 30 70

   * - Section
     - Description
   * - Container Information
     - Provider type, name, URL, region, public access status
   * - Audit Summary
     - Files discovered/scanned/skipped, duration, risk score, severity breakdown
   * - AI Executive Summary
     - 4-6 paragraph CISO-level narrative (AI or heuristic generated)
   * - Technical Findings
     - Full findings grouped by severity with all metadata
   * - AI Insights
     - AI-generated per-file findings labelled separately from deterministic
   * - Compliance Mapping
     - Table of control references triggered by findings
   * - Risk Breakdown
     - Severity-weighted score with category multiplier explanation
   * - Remediation Steps
     - Per-finding actionable remediation guidance
   * - Scan Timeline
     - Phase durations and file inventory
   * - Tool Metadata
     - Version, timestamp, configuration used

Branding
--------

All reports include consistent branding in headers, footers, and metadata:

.. code-block:: text

   Generated by CloudAudit v2.0.0 — Powered by xtawb
   Contact: https://linktr.ee/xtawb
   Defensive read-only audit. No write operations were performed.
